import socket
import nmap

def scan_ports(target):
    open_ports = []
    nm = nmap.PortScanner()
    nm.scan(hosts=target, arguments='-p 1-65535 -sS -T4')
    for host in nm.all_hosts():
        for proto in nm[host].all_protocols():
            ports = nm[host][proto].keys()
            for port in ports:
                if nm[host][proto][port]['state'] == 'open':
                    open_ports.append(port)
    return open_ports

def scan_services(target, ports):
    service_info = {}
    for port in ports:
        try:
            with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
                sock.settimeout(1)
                result = sock.connect_ex((target, port))
                if result == 0:
                    service_info[port] = socket.getservbyport(port)
        except socket.error:
            pass
    return service_info

if __name__ == "__main__":
    target = input("Enter the target IP address: ")
    open_ports = scan_ports(target)
    if open_ports:
        print("Open ports on {}: {}".format(target, open_ports))
        service_info = scan_services(target, open_ports)
        if service_info:
            print("Service information:")
            for port, service_name in service_info.items():
                print("- Port {}: {}".format(port, service_name))
    else:
        print("No open ports found on {}.".format(target))

